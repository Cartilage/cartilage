(function(){Function.prototype.name===void 0&&Object.defineProperty!==void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){var funcNameRegex,results;return funcNameRegex=/function\s([^(]{1,})\(/,results=funcNameRegex.exec(this.toString()),results&&results.length>1?results[1].trim():""},set:function(value){return{}}})}).call(this),function(){this.READONLY=1,this.READWRITE=2,Function.prototype.property=function(name,options){var config,getter,readable,setter,writeable,_ref,_ref1,_ref2,_ref3,_ref4;return options==null&&(options={}),(_ref=options.access)==null&&(options.access=READONLY|READWRITE),(_ref1=options["default"])==null&&(options["default"]=null),(_ref2=options.variable)==null&&(options.variable="_"+name),(_ref3=options.get)==null&&(options.get=null),(_ref4=options.set)==null&&(options.set=null),readable=options.access&READONLY,writeable=options.access&READWRITE,getter=options.get||function(){return _.has(this,options.variable)?this[options.variable]:_.isObject(this[options.variable])&&!_.isFunction(this[options.variable])?this[options.variable]=_.clone(this[options.variable]):this[options.variable]},setter=options.set||function(value){return this[options.variable]=value},config={writeable:writeable,get:readable?getter:void 0,set:writeable?setter:function(){},configurable:!1,enumerable:!0},this.prototype[options.variable]=options["default"],Object.defineProperty(this.prototype,name,config)}}.call(this),function(){_.sum=function(obj){return!_.isArray(obj)||obj.length===0?0:_.reduce(obj,function(sum,n){return sum+=parseInt(n,10)})},_.dasherize=function(string){if(!string)return;return string=string.replace(/([A-Z])/g,function(match){return"-"+match.toLowerCase()}),string=string.replace(/_/g,"-"),string.replace(/^-/,"")},_.camelize=function(string){if(!string)return;return string=string.replace(/((_|-)([a-z]))/g,function(match){return match[1].toUpperCase()}),string=string.replace(/^([A-Z])/g,function(match){return match.toLowerCase()})},_.underscore=function(string){if(!string)return;return string=string.replace(/([A-Z])/g,function(match){return"_"+match.toLowerCase()}),string=string.replace(/-/g,"_"),string.replace(/^_/,"")},_.remove=function(array,value){var index;index=array.indexOf(value);if(index!==-1)return array.splice(index,1)}}.call(this),function($){$.fn.centerPoint=function(){return{x:this.position().left+this.outerWidth(!0)/2,y:this.position().top+this.outerHeight(!0)/2}},$.fn.containsPoint=function(point){var position=this.position(),left=position.left,top=position.top,width=this.outerWidth(!0),height=this.outerHeight(!0);return point.x>=left&&point.x<=left+width&&point.y>=top&&point.y<=top+height},$.fn.overlapped=function(x,y,width,height){var left=$(this).position().left,top=$(this).position().top,right=left+$(this).outerWidth(),bottom=top+$(this).outerHeight();return(x>=left&&x<=right||x+width>=left&&x+width<=right||left>=x&&left<=x+width)&&(y>=top&&y<=bottom||y+height>=top&&y+height<=bottom||top>=y&&top<=y+height)}}(jQuery),function(){window.Cartilage={Version:2,Collections:[],Models:[],Views:[]}}.call(this),function(){window.Cartilage.Application=function(){function Application(){}return Application.Collections={},Application.Models={},Application.Routers={},Application.Views={},Application.sharedInstance=null,Application.launch=function(){return this.sharedInstance=new this,this.sharedInstance.initialize(),this.hijackLinks()},Application.hijackLinks=function(){if(Backbone.history&&Backbone.history._hasPushState)return $(document).delegate("a","click",function(event){var href,protocol;href=$(this).attr("href"),protocol=this.protocol+"//";if(!href)return;if($(this).attr("data-passthrough")==="true")return;if(href.match(/\:\/\//))return;return event.preventDefault(),Backbone.history.navigate(href,!0)})},Application}()}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Model=function(_super){function Model(){return Model.__super__.constructor.apply(this,arguments)}return __extends(Model,_super),Model}(Backbone.Model)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.View=function(_super){function View(options){options==null&&(options={}),_.extend(this,options),Backbone.View.apply(this,arguments)}return __extends(View,_super),View.property("superview",{access:READONLY}),View.property("subviews",{access:READONLY,"default":[]}),View.property("observers",{access:READONLY,"default":[]}),View.prototype.template=function(options){try{if(JST[_.underscore(this.constructor.name)])return JST[_.underscore(this.constructor.name)](options);if(console)return console.info("Missing template "+_.underscore(this.constructor.name)+".jst.ejs for "+this.constructor.name)}catch(error){if(console)return console.error("Template error in "+_.underscore(this.constructor.name)+'.jst.ejs: "'+error.message+'"',error)}},View.prototype.initialize=function(options){return options==null&&(options={}),_.extend(this,options)},View.prototype.prepare=function(){},View.prototype.render=function(){var _ref;return $(this.el).addClass(this.determineClassName()),(_ref=this.templateVariables)==null&&(this.templateVariables={}),this.collection&&(this.templateVariables[_.camelize(this.collection.constructor.name)]=this.collection),this.model&&(this.templateVariables[_.camelize(this.model.constructor.name)]=this.model),$(this.el).html(this.template(this.templateVariables)),this},View.prototype.cleanup=function(){return this.off(),this.removeObservers(),this.remove()},View.prototype.observe=function(source,event,callback){return source.on(event,callback,this),this._observers.push({source:source,event:event,callback:callback})},View.prototype.removeObservers=function(){return _.each(this.observers,function(observer){return observer.source.off(observer.event,observer.callback,this)}),this._observers=[]},View.prototype.addSubview=function(view,container,animated){container==null&&(container=this.el),animated==null&&(animated=!1);if(!view)return;return this._subviews.push(view),view._superview=this,view.isRendered||(view.render(),view.isRendered=!0,view.trigger("rendered")),$(view.el).css("visibility","hidden").show(),$(container).append(view.el),view.isPrepared||(view.prepare&&view.prepare(),view.isPrepared=!0,view.trigger("prepared")),view.trigger("willPresent"),animated?($(view.el).hide(),$(view.el).css("visibility","visible"),$(view.el).fadeIn(750,function(){return view.trigger("presented")})):($(view.el).css("visibility","visible"),view.trigger("presented"))},View.prototype.addSubviewAnimated=function(view,container){return container==null&&(container=this.el),this.addSubview(view,container,!0)},View.prototype.removeFromSuperview=function(animated){var _this=this;return animated==null&&(animated=!1),this.trigger("willRemove"),this.off(),this.removeObservers(),animated?$(this.el).fadeOut(750,function(){return _this.trigger("removed"),$(_this.el).detach()}):($(this.el).hide(),this.trigger("removed"),$(this.el).detach()),_.remove(this._superview._subviews,this),this._superview=null},View.prototype.removeFromSuperviewAnimated=function(){return this.removeFromSuperview(!0)},View.prototype.determineClassName=function(){var classNames,superklass;classNames=[_.dasherize(this.constructor.name)],superklass=this.constructor.__super__;while(superklass)classNames.push(_.dasherize(superklass.constructor.name)),superklass=superklass.constructor.__super__;return classNames=classNames.reverse(),_.isFunction(this.className)?classNames.push(this.className().split(" ")):this.className&&classNames.push(this.className.split(" ")),classNames=_.flatten(classNames),classNames=_.compact(classNames),classNames=_.unique(classNames),classNames.join(" ")},View.superclasses=function(){var classes,superklass;classes=[superklass=this.__super__];while(superklass=superklass.constructor.__super__)classes.push(superklass);return classes.reverse()},View}(Backbone.View)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Models.Segment=function(_super){function Segment(){return Segment.__super__.constructor.apply(this,arguments)}return __extends(Segment,_super),Segment}(Cartilage.Model)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Collections.Segments=function(_super){function Segments(){return Segments.__super__.constructor.apply(this,arguments)}return __extends(Segments,_super),Segments.prototype.model=Cartilage.Models.Segment,Segments}(Backbone.Collection)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.BarSegmentView=function(_super){function BarSegmentView(){return BarSegmentView.__super__.constructor.apply(this,arguments)}return __extends(BarSegmentView,_super),BarSegmentView.prototype.tagName="li",BarSegmentView.property("barView",{access:READONLY}),BarSegmentView.property("color",{"default":"#eeeeee"}),BarSegmentView.property("fillWidth",{"default":0}),BarSegmentView.property("width",{"default":0}),BarSegmentView.prototype.initialize=function(options){return options==null&&(options={}),BarSegmentView.__super__.initialize.call(this,options),this._barElement=$("<div />").addClass("bar"),$(this._barElement).css({width:this.fillWidth*100+"%",backgroundColor:this.color})},BarSegmentView.prototype.prepare=function(){return BarSegmentView.__super__.prepare.call(this),$(this.el).html(this._barElement),this.fillWidth>0&&$(this._barElement).css({display:"block"}),$(this.el).css({width:this.width*100+"%"})},BarSegmentView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.BarView=function(_super){function BarView(){return this._percentageWidthForSegmentAtIndex=__bind(this._percentageWidthForSegmentAtIndex,this),BarView.__super__.constructor.apply(this,arguments)}return __extends(BarView,_super),BarView.prototype.tagName="ul",BarView.property("segments",{"default":new Cartilage.Collections.Segments}),BarView.property("value",{"default":0}),BarView.property("colors",{"default":["#6ba2d4","#a765a2","#f69062","#8ccc64","#c26bb4","#e9d243"]}),BarView.prototype._cumulativeWidth=0,BarView.prototype.prepare=function(){var _this=this;return BarView.__super__.prepare.call(this),_.each(this.segments.models,function(segment,index){var barWidth,segmentView,segmentWidth;return segmentWidth=_this._percentageWidthForSegmentAtIndex(index),barWidth=_this._percentageWidthForBarInSegmentAtIndex(index),segmentView=new Cartilage.Views.BarSegmentView({barView:_this,model:segment,width:segmentWidth,fillWidth:barWidth,color:_this.colors[index]}),_this.addSubview(segmentView)})},BarView.prototype._percentageWidthForSegmentAtIndex=function(index){var computedWidth,segment,segmentWidth,totalWidth,_ref;return segment=this.segments.models[index],segmentWidth=segment.get("maximum")-((_ref=this.segments.models[index-1])!=null?_ref.get("maximum"):void 0)||segment.get("maximum"),totalWidth=_.last(this.segments.models).get("maximum"),computedWidth=segmentWidth/totalWidth,computedWidth>.02||(computedWidth=.02),this.segments.models[index+1]==null&&(computedWidth=1-this._cumulativeWidth),this._cumulativeWidth+=computedWidth,computedWidth},BarView.prototype._percentageWidthForBarInSegmentAtIndex=function(index){var barWidth,fooWidth,segment,segmentWidth,_ref;return segment=this.segments.models[index],segmentWidth=segment.get("maximum")-((_ref=this.segments.models[index-1])!=null?_ref.get("maximum"):void 0)||segment.get("maximum"),fooWidth=this.value-_.sum(_.map(this.segments.models.slice(0,index),function(segment){return segment.get("maximum")})),barWidth=0,fooWidth<=0?0:(this.value>segment.get("maximum")?barWidth=1:barWidth=fooWidth/segmentWidth,barWidth)},BarView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.ImageView=function(_super){function ImageView(){return this.handleErrorEvent=__bind(this.handleErrorEvent,this),this.handleLoadEvent=__bind(this.handleLoadEvent,this),ImageView.__super__.constructor.apply(this,arguments)}return __extends(ImageView,_super),ImageView.property("imageAddress",{set:function(url){return this._imageAddress=url,this._imageElement=$("<img />").attr("src",this.imageAddress),$(this._imageElement).load(this.handleLoadEvent),$(this._imageElement).error(this.handleErrorEvent)}}),ImageView.property("isLoaded",{access:READONLY,"default":!1}),ImageView.property("isError",{access:READONLY,"default":!1}),ImageView.property("imageElement",{access:READONLY}),ImageView.prototype.render=function(){return ImageView.__super__.render.call(this),$(this.el).html(this._imageElement),this},ImageView.prototype.cleanup=function(){return this.clear({silent:!0}),ImageView.__super__.cleanup.call(this)},ImageView.prototype.clear=function(options){options==null&&(options={}),this._isLoaded=!1,this._imageAddress=null,$(this._imageElement).off().hide().attr("src",null);if(!options.silent)return this.trigger("cleared")},ImageView.prototype.handleLoadEvent=function(event){return this._isLoaded=!0,this._isError=!1,this.imageElement.is(":visible")||this.imageElement.fadeIn(),this.trigger("load",event)},ImageView.prototype.handleErrorEvent=function(event){return this.clear(),this._isError=!0,this.trigger("error",event)},ImageView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};window.Cartilage.Views.ListViewItem=function(_super){function ListViewItem(){return this.onDragOver=__bind(this.onDragOver,this),this.onDragStart=__bind(this.onDragStart,this),this.onDragLeave=__bind(this.onDragLeave,this),ListViewItem.__super__.constructor.apply(this,arguments)}return __extends(ListViewItem,_super),ListViewItem.prototype.id=function(){return"list-view-item-"+Math.floor(Math.random()*1e9)},ListViewItem.prototype.tagName="li",ListViewItem.prototype.events={dragover:"onDragOver",dragleave:"onDragLeave",dragstart:"onDragStart"},ListViewItem.property("listView",{access:READONLY}),ListViewItem.property("isSelected",{access:READONLY,"default":!1}),ListViewItem.prototype.initialize=function(options){return options==null&&(options={}),ListViewItem.__super__.initialize.call(this,options),$(this.el).attr("tabindex",0),$(this.el).data("model",this.model),$(this.el).data("view",this)},ListViewItem.prototype.prepare=function(){ListViewItem.__super__.prepare.call(this);if(this.listView&&this.listView.allowsDragToReorder)return $(this.el).attr("draggable",!0)},ListViewItem.prototype.onDragLeave=function(event){if(!this.listView.allowsDragToReorder)return;return $(this.el).removeClass("drop-before").removeClass("drop-after")},ListViewItem.prototype.onDragStart=function(event){if(!this.listView.allowsDragToReorder)return;return event.originalEvent.dataTransfer.setData("application/x-list-view-item-id",$(this.el).attr("id")),Cartilage.Views.ListView.draggedItem=this},ListViewItem.prototype.onDragOver=function(event){var allowed,_ref;if(!this.listView.allowsDragToReorder)return;allowed=!0,__indexOf.call(event.originalEvent.dataTransfer.types,"application/x-list-view-item-id")<0&&(allowed=!1);if(_ref=Cartilage.Views.ListView.draggedItem.model,__indexOf.call(this.listView.collection.models,_ref)<0)allowed=!1;if(allowed)return event.originalEvent.offsetY<$(this.el).height()/2?$(this.el).removeClass("drop-after").addClass("drop-before"):$(this.el).removeClass("drop-before").addClass("drop-after")},ListViewItem}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};window.Cartilage.Views.ListView=function(_super){function ListView(){return this.moveSelectionDown=__bind(this.moveSelectionDown,this),this.moveSelectionUp=__bind(this.moveSelectionUp,this),this.onDrop=__bind(this.onDrop,this),this.onDragOver=__bind(this.onDragOver,this),this.onKeyDown=__bind(this.onKeyDown,this),this.onFocus=__bind(this.onFocus,this),this.onMouseDown=__bind(this.onMouseDown,this),this.remove=__bind(this.remove,this),this.restoreSelection=__bind(this.restoreSelection,this),this.selectAnother=__bind(this.selectAnother,this),this.select=__bind(this.select,this),this.addItem=__bind(this.addItem,this),this.addModel=__bind(this.addModel,this),this.renderModel=__bind(this.renderModel,this),this.renderModels=__bind(this.renderModels,this),ListView.__super__.constructor.apply(this,arguments)}return __extends(ListView,_super),ListView.property("allowsRemove",{"default":!1}),ListView.property("allowsSelection",{"default":!0}),ListView.property("allowsDeselection",{"default":!0}),ListView.property("allowsMultipleSelection",{"default":!1}),ListView.property("allowsDragToReorder",{"default":!1}),ListView.property("itemView",{"default":Cartilage.Views.ListViewItem}),ListView.property("selected",{access:READONLY}),ListView.property("items",{access:READONLY,"default":new Backbone.Collection}),ListView.draggedItem=void 0,ListView.prototype.events={"dblclick ul > li":"open","click ul > li":"onFocus","keydown ul":"onKeyDown","mousedown ul":"onMouseDown","dragover ul":"onDragOver","drop ul":"onDrop"},ListView.prototype.initialize=function(options){var _this=this;return options==null&&(options={}),ListView.__super__.initialize.call(this,options),$(this.el).append(this._listViewItemsContainer=this.make("ul",{"class":"list-view-items-container",tabindex:0})),this._selected=new Backbone.Collection(null,{comparator:function(item){return _this.collection.indexOf(item)}}),this.observe(this.collection,"add",this.addModel),this.observe(this.collection,"reset",this.update),this.observe(this.collection,"remove",this.prepare)},ListView.prototype.prepare=function(){return ListView.__super__.prepare.call(this),this.update()},ListView.prototype.update=function(){var _this=this;this.$("li").each(function(idx,element){var view;return(view=$(element).data("view"))?view.removeFromSuperview():$(element).remove()}),_.each(this.renderModels(),function(view){return _this.addSubview(view,_this._listViewItemsContainer)});if(this._selected.models.length>0)return this.restoreSelection()},ListView.prototype.renderModels=function(){var items,_this=this;return items=_.map(this.collection.models,function(model){return _this.renderModel(model)})},ListView.prototype.renderModel=function(model){return this.itemView!=null?new this.itemView({model:model,listView:this}):console.warn("Could not find corresponding itemView for "+this.constructor.name)},ListView.prototype.addModel=function(model){return this.addItem(this.renderModel(model))},ListView.prototype.addItem=function(item){return this.addSubview(item,this._listViewItemsContainer),this.collection.add(item.model,{silent:!0})},ListView.prototype.select=function(e){var element,model,_this=this;if(!this.allowsSelection)return;element=_.isUndefined(e.target)?e:e.target,model=$(element).data("model");if(__indexOf.call(this._selected.models,model)>=0)return;return this.allowsMultipleSelection?this._selected.length>0&&this.clearSelection():_.each($(this.el).find("li.selected"),function(element){return _this.deselect(element)}),this._selected.add(model),$(element).addClass("selected"),this.focusedElement=$(element),this.trigger("select",this._selected)},ListView.prototype.selectAnother=function(e){var element,model;if(!this.allowsSelection||!this.allowsMultipleSelection){this.select(e);return}element=e.target||e,model=$(element).data("model");if(__indexOf.call(this._selected.models,model)>=0)return;return this._selected.add(model),$(element).addClass("selected"),this.trigger("select",this._selected)},ListView.prototype.selectFirst=function(){var element;return element=$(this.el).find("li").first(),this.select(element)},ListView.prototype.selectLast=function(){var element;return element=$(this.el).find("li:last-of-type"),this.select(element)},ListView.prototype.selectAll=function(){var elements;if(!this.allowsSelection||!this.allowsMultipleSelection)return;return elements=$(this.el).find("li:not(.selected)"),_.each(elements,this.selectAnother)},ListView.prototype.restoreSelection=function(){var elements,_this=this;return elements=$(this.el).find("li"),_.each(elements,function(element){var model;return model=$(element).data("model"),__indexOf.call(_this._selected.models,model)>=0?$(element).addClass("selected"):_this._selected.remove(model)})},ListView.prototype.deselect=function(element){var model;return model=$(element).data("model"),$(element).removeClass("selected"),this._selected.remove(model),this.trigger("deselect",element)},ListView.prototype.clearSelection=function(options){options==null&&(options={}),$(this.el).find("li.selected").removeClass("selected"),this._selected.reset(null,{silent:options.silent});if(!options.silent)return this.trigger("clear",this._selected)},ListView.prototype.open=function(e){return this.trigger("open",this._selected)},ListView.prototype.remove=function(e){if(!this.allowsRemove)return;return this.collection.remove(this._selected.models),this._selected.reset(),this.trigger("remove",this._selected)},ListView.prototype.onMouseDown=function(event){var element,model;element=$(event.target).is("li")?event.target:$(event.target).parents("li"),this.allowsDeselection&&event.target.tagName==="UL"&&this.clearSelection();if(event.metaKey)return model=$(element).data("model"),__indexOf.call(this._selected.models,model)>=0?this.deselect(element):this.selectAnother(element),event.preventDefault();if(event.shiftKey)return element=event.target,this.expandSelectionToElement($(element).parents("li")||element),event.preventDefault()},ListView.prototype.onFocus=function(event){return this.focusedElement=$(event.target).closest("li"),event.metaKey||this.select(this.focusedElement),event.preventDefault()},ListView.prototype.onKeyDown=function(event){var keyCode;keyCode=event.keyCode;if(keyCode===38||keyCode===40||keyCode===63232||keyCode===63233){event.preventDefault();if(!(this._selected.length>0))return this.selectFirst();if(event.shiftKey||event.metaKey){if(keyCode===38||keyCode===63232)return this.expandSelectionUp(event);if(keyCode===40||keyCode===63233)return this.expandSelectionDown(event)}else{if(keyCode===38||keyCode===63232)return this.moveSelectionUp(event);if(keyCode===40||keyCode===63233)return this.moveSelectionDown(event)}}if(keyCode===65&&event.metaKey)return event.preventDefault(),this.selectAll();if(keyCode===13)return event.preventDefault(),this.open(event.target);if(keyCode===8||keyCode===46)return event.preventDefault(),this.remove(event.target);if(keyCode===32)return event.preventDefault()},ListView.prototype.onDragOver=function(event){var allowed,_ref;if(!this.allowsDragToReorder)return;allowed=!0,__indexOf.call(event.originalEvent.dataTransfer.types,"application/x-list-view-item-id")<0&&(allowed=!1);if(_ref=Cartilage.Views.ListView.draggedItem.model,__indexOf.call(this.collection.models,_ref)<0)allowed=!1;if(allowed)return event.preventDefault()},ListView.prototype.onDrop=function(event){var draggedElement,draggedElementId,droppedElement;if(!this.allowsDragToReorder)return;return draggedElementId=event.originalEvent.dataTransfer.getData("application/x-list-view-item-id"),draggedElement=$("#"+draggedElementId),droppedElement=$(event.target).parents("li.list-view-item")[0]||$(event.target)[0],$(draggedElement)[0]!==$(droppedElement)[0]&&droppedElement&&droppedElement.tagName==="LI"&&(event.originalEvent.offsetY<$(droppedElement).height()/2?$(draggedElement).detach().insertBefore(droppedElement):$(draggedElement).detach().insertAfter(droppedElement)),$(droppedElement).removeClass("drop-before").removeClass("drop-after"),Cartilage.Views.ListView.draggedItem=!1},ListView.prototype.moveSelectionUp=function(e){var element;element=$(this.focusedElement).prev("li");if(element.length>0)return this.select(element)},ListView.prototype.moveSelectionDown=function(e){var element;element=$(this.focusedElement).next("li");if(element.length>0)return this.select(element)},ListView.prototype.expandSelectionDown=function(e){var element;element=$(this.focusedElement).next("li");if(element.length>0)return this.selectAnother(element),this.focusedElement=$(element).focus()},ListView.prototype.expandSelectionUp=function(e){var element;element=$(this.focusedElement).prev("li");if(element.length>0)return this.selectAnother(element),this.focusedElement=$(element).focus()},ListView.prototype.expandSelectionToElement=function(element){var elements,indexes,_ref;return indexes=[$(this.focusedElement).index(),$(element).index()].sort(function(a,b){return a-b}),indexes[1]+=1,elements=(_ref=$(this.el).find("li")).slice.apply(_ref,indexes),_.each(elements,this.selectAnother)},ListView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.LoadingIndicatorView=function(_super){function LoadingIndicatorView(){return this._animateNextFrame=__bind(this._animateNextFrame,this),this.remove=__bind(this.remove,this),this.start=__bind(this.start,this),LoadingIndicatorView.__super__.constructor.apply(this,arguments)}return __extends(LoadingIndicatorView,_super),LoadingIndicatorView.property("barCount",{"default":10}),LoadingIndicatorView.property("barSize",{"default":{width:4,height:12}}),LoadingIndicatorView.property("barColor",{"default":{red:85,green:85,blue:85}}),LoadingIndicatorView.property("centerPosition",{"default":{x:48,y:48}}),LoadingIndicatorView.property("innerRadius",{"default":10}),LoadingIndicatorView.property("isAnimating",{access:READONLY,"default":!1}),LoadingIndicatorView.prototype.initialize=function(options){return options==null&&(options={}),LoadingIndicatorView.__super__.initialize.call(this,options),$(this.el).html(this._canvasElement=this.make("canvas",{width:96,height:96})),this._canvasContext=this._canvasElement.getContext("2d"),this.observe(this,"willPresent",this.start),this.observe(this,"removed",this.stop)},LoadingIndicatorView.prototype.prepare=function(){var blue,color,colors,green,red;LoadingIndicatorView.__super__.prepare.call(this);if(color=$(this.el).css("color"))return colors=color.split(","),red=parseInt(colors[0].substr(4,3),10),green=parseInt(colors[1],10),blue=parseInt(colors[2],10),this.barColor={red:red,green:green,blue:blue}},LoadingIndicatorView.prototype.start=function(){if(this.isAnimating)return;return this._isAnimating=!0,this._animateNextFrame(),this.isAnimating},LoadingIndicatorView.prototype.stop=function(){if(!this.isAnimating)return;return this._clearFrame(this._canvasContext),this._isAnimating=!1},LoadingIndicatorView.prototype.remove=function(){return this.stop()&&LoadingIndicatorView.__super__.remove.call(this)},LoadingIndicatorView.prototype._draw=function(context,offset){var currentBar,i,pos,_i,_ref;this._clearFrame(context),context.save(),context.translate(this.centerPosition.x,this.centerPosition.y);for(i=_i=0,_ref=this.barCount;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i)currentBar=(offset+i)%this.barCount,pos=this._calculatePosition(currentBar),context.save(),context.translate(pos.x,pos.y),context.rotate(pos.angle),this._drawBlock(this._canvasContext,i),context.restore();return context.restore()},LoadingIndicatorView.prototype._drawBlock=function(context,barNumber){return context.fillStyle=this._makeRGBA(this.barColor.red,this.barColor.green,this.barColor.blue,(this.barCount+1-barNumber)/(this.barCount+1)),context.fillRect(-this.barSize.width/2,0,this.barSize.width,this.barSize.height)},LoadingIndicatorView.prototype._animateNextFrame=function(){if(!this.isAnimating)return;return this._currentOffset=_.isUndefined(this._currentOffset)?1:(this._currentOffset+1)%this.barCount,this._draw(this._canvasContext,this._currentOffset),_.delay(this._animateNextFrame,50)},LoadingIndicatorView.prototype._clearFrame=function(context){return context.clearRect(0,0,this._canvasElement.clientWidth,this._canvasElement.clientHeight)},LoadingIndicatorView.prototype._calculateAngle=function(barNumber){return 2*barNumber*Math.PI/this.barCount},LoadingIndicatorView.prototype._calculatePosition=function(barNumber){var angle;return angle=this._calculateAngle(barNumber),{y:this.innerRadius*Math.cos(-angle),x:this.innerRadius*Math.sin(-angle),angle:angle}},LoadingIndicatorView.prototype._makeRGBA=function(){return"rgba("+arguments[0]+", "+arguments[1]+", "+arguments[2]+", "+arguments[3]+")"},LoadingIndicatorView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};window.Cartilage.Views.MatrixView=function(_super){function MatrixView(){return this.moveSelectionRight=__bind(this.moveSelectionRight,this),this.moveSelectionLeft=__bind(this.moveSelectionLeft,this),this.onKeyDown=__bind(this.onKeyDown,this),this.onMouseMove=__bind(this.onMouseMove,this),this.onMouseUp=__bind(this.onMouseUp,this),this.onMouseDown=__bind(this.onMouseDown,this),MatrixView.__super__.constructor.apply(this,arguments)}return __extends(MatrixView,_super),MatrixView.prototype.events=_.extend({mouseup:"onMouseUp",mousemove:"onMouseMove",mousedown:"onMouseDown"},Cartilage.Views.ListView.prototype.events),MatrixView.property("allowsDragSelection",{"default":!1}),MatrixView.prototype.initialize=function(options){options==null&&(options={}),MatrixView.__super__.initialize.call(this,options);if(this.allowsDragSelection)return $(this.el).append($("<div/>").addClass("overlay").hide())},MatrixView.prototype.onMouseDown=function(event){MatrixView.__super__.onMouseDown.call(this,event);if(!this.allowsDragSelection
)return;if(event.button!==0)return;return this.isDragging=!0,this.originX=event.pageX-$(this.el).offset().left,this.originY=event.pageY-$(this.el).offset().top,this.originScrollTop=$(this.el).scrollTop(),this.originScrollLeft=$(this.el).scrollLeft(),this.$(".overlay").css({width:"0px",height:"0px",left:event.pageX,top:event.pageY})},MatrixView.prototype.onMouseUp=function(event){return this.isDragging=!1,this.$(".overlay").hide().css({width:"0px",height:"0px"})},MatrixView.prototype.onMouseMove=function(event){var height,left,overlayElement,top,width,_this=this;if(!this.isDragging)return;return overlayElement=this.$(".overlay"),overlayElement.show(),left=this.originX,top=this.originY,width=event.pageX-$(this.el).offset().left-this.originX,height=event.pageY-$(this.el).offset().top-this.originY,width<0?(width=-width,left=event.pageX-$(this.el).offset().left):left=this.originX,height<0?(height=-height,top=event.pageY-$(this.el).offset().top):top=this.originY,$(this.el).scrollTop()===this.originScrollTop?top+=this.originScrollTop:$(this.el).scrollTop()>this.originScrollTop?(top+=this.originScrollTop,height+=$(this.el).scrollTop()-this.originScrollTop):$(this.el).scrollTop()<this.originScrollTop&&(top+=$(this.el).scrollTop(),height+=$(this.el).scrollTop()+this.originScrollTop),overlayElement.css({left:left+"px",top:top+"px",width:width+"px",height:height+"px"}),_.each(this.$("li"),function(element){return $(element).overlapped(left,top-$(_this.el).scrollTop(),width,height)?_this.selectAnother(element):_this.deselect(element)})},MatrixView.prototype.onKeyDown=function(event){var keyCode;keyCode=event.keyCode;if(__indexOf.call([37,38,39,40],keyCode)>=0||__indexOf.call([63232,63233,63234,63235],keyCode)>=0){event.preventDefault();if(!(this.selected.length>0))return this.selectFirst();if(event.shiftKey||event.metaKey){if(keyCode===37||keyCode===63234)return this.expandSelectionLeft(event);if(keyCode===38||keyCode===63232)return this.expandSelectionUp(event);if(keyCode===39||keyCode===63235)return this.expandSelectionRight(event);if(keyCode===40||keyCode===63233)return this.expandSelectionDown(event)}else{if(keyCode===37||keyCode===63234)return this.moveSelectionLeft(event);if(keyCode===38||keyCode===63232)return this.moveSelectionUp(event);if(keyCode===39||keyCode===63235)return this.moveSelectionRight(event);if(keyCode===40||keyCode===63233)return this.moveSelectionDown(event)}}if(keyCode===65&&event.metaKey)return event.preventDefault(),this.selectAll();if(keyCode===13)return event.preventDefault(),this.open(event.target);if(keyCode===8||keyCode===46)return event.preventDefault(),this.remove(event.target);if(keyCode===32)return event.preventDefault()},MatrixView.prototype.moveSelectionLeft=function(e){var element;element=$(this.focusedElement).prev("li");if(element.length>0)return this.clearSelection()&&this.select(element),this.focusedElement=$(element).focus()},MatrixView.prototype.moveSelectionRight=function(e){var element;element=$(this.focusedElement).next("li");if(element.length>0)return this.clearSelection()&&this.select(element),this.focusedElement=$(element).focus()},MatrixView.prototype.moveSelectionDown=function(e){var centerPoint,element,elements;centerPoint=$(this.focusedElement).centerPoint(),centerPoint.y+=$(this.focusedElement).outerHeight(!0),elements=$(this.focusedElement).nextAll("li"),element=elements.filter(function(idx,element){return $(element).containsPoint(centerPoint)});if(element.length>0)return this.clearSelection()&&this.select(element),this.focusedElement=$(element).focus()},MatrixView.prototype.moveSelectionUp=function(e){var centerPoint,element,elements;centerPoint=$(this.focusedElement).centerPoint(),centerPoint.y-=$(this.focusedElement).outerHeight(!0),elements=$(this.focusedElement).prevAll("li"),element=elements.filter(function(idx,element){return $(element).containsPoint(centerPoint)});if(element.length>0)return this.clearSelection()&&this.select(element),this.focusedElement=$(element).focus()},MatrixView.prototype.expandSelectionLeft=function(e){var element;element=$(this.focusedElement).prev("li");if(element.length>0)return this.selectAnother(element),this.focusedElement=$(element).focus()},MatrixView.prototype.expandSelectionRight=function(e){var element;element=$(this.focusedElement).next("li");if(element.length>0)return this.selectAnother(element),this.focusedElement=$(element).focus()},MatrixView.prototype.expandSelectionDown=function(e){var centerPoint,element,elements;return centerPoint=$(this.focusedElement).centerPoint(),centerPoint.y+=$(this.focusedElement).outerHeight(!0),elements=$(this.focusedElement).nextAll("li"),element=elements.filter(function(idx,element){return $(element).containsPoint(centerPoint)}),element.length>0&&this.selectAnother(element),this.focusedElement=$(element).focus()},MatrixView.prototype.expandSelectionUp=function(e){var centerPoint,element,elements;return centerPoint=$(this.focusedElement).centerPoint(),centerPoint.y-=$(this.focusedElement).outerHeight(!0),elements=$(this.focusedElement).prevAll("li"),element=elements.filter(function(idx,element){return $(element).containsPoint(centerPoint)}),element.length>0&&this.selectAnother(element),this.focusedElement=$(element).focus()},MatrixView}(Cartilage.Views.ListView)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.MatrixViewItem=function(_super){function MatrixViewItem(){return MatrixViewItem.__super__.constructor.apply(this,arguments)}return __extends(MatrixViewItem,_super),MatrixViewItem}(Cartilage.Views.ListViewItem)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.ModalView=function(_super){function ModalView(){return this.cleanup=__bind(this.cleanup,this),this.hide=__bind(this.hide,this),ModalView.__super__.constructor.apply(this,arguments)}return __extends(ModalView,_super),ModalView.prototype.className="modal fade",ModalView.prototype.render=function(){return $(this.el).html(this.template({model:this.model})),this},ModalView.prototype.show=function(){return $(document.body).append(this.render().el),$(this.el).modal("show"),$(this.el).on("hidden",this.cleanup)},ModalView.prototype.hide=function(){return $(this.el).modal("hide")},ModalView.prototype.cleanup=function(){return $(this.el).off("hidden"),ModalView.__super__.cleanup.call(this)},ModalView}(Cartilage.View)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.PopoverView=function(_super){function PopoverView(){return this.handleDocumentClickEvent=__bind(this.handleDocumentClickEvent,this),PopoverView.__super__.constructor.apply(this,arguments)}return __extends(PopoverView,_super),PopoverView.property("attachedView"),PopoverView.property("position",{"default":"top"}),PopoverView.prototype._contentElement=null,PopoverView.prototype._triangleElement=null,PopoverView.prototype.initialize=function(options){return options==null&&(options={}),PopoverView.__super__.initialize.call(this,options),$(this.el).append(this._triangleElement=this.make("div",{"class":"triangle"})),$(this.el).append(this._contentElement=this.make("div",{"class":"content-view"}))},PopoverView.prototype.prepare=function(){return PopoverView.__super__.prepare.call(this),this._calculatePosition()},PopoverView.prototype._calculatePosition=function(){var height,left,maxHeight,maxWidth,offset,top,width;if(!this.attachedElement)return;this.resizeToFitContents(),offset=$(this.attachedElement).offset(),width=$(this.attachedElement).outerWidth(),height=$(this.attachedElement).outerHeight(),top=null,left=null;switch(this.position){case"top":top=offset.top-$(this.el).outerHeight(!0),left=offset.left+width/2-$(this.el).outerWidth(!0)/2,offset.top-$(this.el).outerHeight(!0)<0&&(top=offset.top+height,this.position="bottom");break;case"bottom":top=offset.top+height,left=offset.left+width/2-$(this.el).outerWidth(!0)/2,maxHeight=$(document).height(),offset.top+height+$(this.el).outerHeight(!0)>maxHeight&&(top=offset.top-$(this.el).outerHeight(!0),this.position="top");break;case"left":top=offset.top+height/2-$(this.el).outerHeight(!0)/2,left=offset.left-$(this.el).outerWidth(!0),offset.left-$(this.el).outerWidth(!0)<0&&(left=offset.left+width,this.position="right");break;case"right":top=offset.top+height/2-$(this.el).outerHeight(!0)/2,left=offset.left+width,maxWidth=$(document).width(),offset.left+width+$(this.el).outerWidth(!0)>maxWidth&&(left=offset.left-$(this.el).outerWidth(!0),this.position="left")}return $(this.el).removeClass("top"),$(this.el).removeClass("right"),$(this.el).removeClass("bottom"),$(this.el).removeClass("left"),$(this.el).addClass(this.position),$(this.el).css({top:""+top+"px",left:""+left+"px"})},PopoverView.prototype.presentRelativeToElement=function(element,position){return this.attachedElement=element,this.position=position!=null?position:position="top",$(this.el).css({visibility:"hidden"}),$(this._contentElement).children().css("display","block"),$(document.body).append(this.render().el),this._calculatePosition(),$(this.el).hide().css({visibility:"visible"}),$(this.el).fadeIn(),$(document).unbind("click",this.handleDocumentClickEvent).click(this.handleDocumentClickEvent)},PopoverView.prototype.resizeToFitContents=function(){var element,height,width;return element=$(this._contentElement).children()[0],width=$(element).outerWidth(),height=$(element).outerHeight(),$(this._contentElement).css({width:""+width+"px",height:""+height+"px"}),$(this.el).css({width:""+width+"px",height:""+height+"px"})},PopoverView.prototype.handleDocumentClickEvent=function(event){var _this=this;if(event.target===this.attachedElement)return;return $(document).unbind("click",this.handleDocumentClickEvent),$(this.el).fadeOut("fast",function(){return $(_this.el).remove()})},PopoverView}(Cartilage.View)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.SourceListViewItem=function(_super){function SourceListViewItem(){return SourceListViewItem.__super__.constructor.apply(this,arguments)}return __extends(SourceListViewItem,_super),SourceListViewItem}(Cartilage.Views.ListViewItem)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.SourceListView=function(_super){function SourceListView(){return SourceListView.__super__.constructor.apply(this,arguments)}return __extends(SourceListView,_super),SourceListView.property("headerView"),SourceListView.property("footerView"),SourceListView.property("itemView",{"default":Cartilage.Views.SourceListViewItem}),SourceListView.prototype.initialize=function(options){options==null&&(options={}),SourceListView.__super__.initialize.call(this,options),this.headerView&&$(this.el).append(this._headerViewContainer=this.make("div",{"class":"header-view"}));if(this.footerView)return $(this.el).append(this._footerViewContainer=this.make("div",{"class":"footer-view"}))},SourceListView.prototype.prepare=function(){SourceListView.__super__.prepare.call(this),this.headerView&&(this.addSubview(this.headerView,this._headerViewContainer),$(this._listViewItemsContainer).css("top",$(this.headerView.el).outerHeight()),$(this._headerViewContainer).css("height",$(this.headerView.el).outerHeight()));if(this.footerView)return this.addSubview(this.footerView,this._footerViewContainer),$(this._listViewItemsContainer).css("bottom",$(this.footerView.el).outerHeight()),$(this._footerViewContainer).css("height",$(this.footerView.el).outerHeight())},SourceListView}(Cartilage.Views.ListView)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.SplitView=function(_super){function SplitView(){return this.onMouseMove=__bind(this.onMouseMove,this),this.onMouseUp=__bind(this.onMouseUp,this),this.onMouseDown=__bind(this.onMouseDown,this),this.handleWindowResize=__bind(this.handleWindowResize,this),this.position=__bind(this.position,this),SplitView.__super__.constructor.apply(this,arguments)}return __extends(SplitView,_super),SplitView.property("firstView",{"default":null}),SplitView.property("secondView",{"default":null}),SplitView.property("orientation",{"default":"vertical"}),SplitView.property("isResizable",{"default":!0}),SplitView.prototype.events={"mousedown .drag-handle":"onMouseDown",mouseup:"onMouseUp",mousemove:"onMouseMove"},SplitView.prototype.initialize=function(options){return options==null&&(options={}),$(this.el).append(this._firstViewContainer=this.make("div",{"class":"first-view"})),$(this.el).append(this._secondViewContainer=this.make("div",{"class":"second-view"})),this.isResizable&&$(this.el).append(this.dragElement=this.make("div",{"class":"drag-handle"})),$(this.el).addClass(this.orientation),$(window).on("resize",this.handleWindowResize),SplitView.__super__.initialize.call(this,options)},SplitView.prototype.prepare=function(){return SplitView.__super__.prepare.call(this),this.addSubview(this.firstView,this._firstViewContainer),this.addSubview(this.secondView,this._secondViewContainer),this.orientation==="vertical"?this.position($(this._firstViewContainer).width()):this.position(0)},SplitView.prototype.cleanup=function(){return $(window).off("resize",this.handleWindowResize),this.firstView&&this.firstView.cleanup&&this.firstView.cleanup(),this.secondView&&this.secondView.cleanup&&this.secondView.cleanup(),SplitView.__super__.cleanup.call(this)},SplitView.prototype.position=function(newPosition,options){var bottom,maxHeight,maxWidth,minHeight,minWidth;return options==null&&(options={}),newPosition==null?this._currentPosition:(this.orientation==="vertical"?(minWidth=parseInt($(this._firstViewContainer).css("min-width")),maxWidth=parseInt($(this._firstViewContainer).css("max-width")),newPosition<minWidth?newPosition=minWidth:newPosition>maxWidth&&(newPosition=maxWidth),options.animated?($(this._firstViewContainer).css({left:""}),$(this._firstViewContainer).animate({width:newPosition+"px"},250),$(this._secondViewContainer).css({width:""}),$(this._secondViewContainer).animate({left:newPosition+"px"},250)):($(this._firstViewContainer).css({width:newPosition+"px",left:""}),$(this._secondViewContainer).css({left:newPosition+"px",width:""})),$(this.dragElement).css("left",newPosition-$(this.dragElement).width()/2+"px")):(minHeight=parseInt($(this._secondViewContainer).css("min-height")),maxHeight=parseInt($(this._secondViewContainer).css("max-height")),newPosition<minHeight?newPosition=minHeight:newPosition>maxHeight&&(newPosition=maxHeight),bottom=$(this.el).height()-newPosition,options.animated?($(this._firstViewContainer).css({bottom:""}),$(this._firstViewContainer).animate({height:bottom+"px"},250),$(this._secondViewContainer).css({height:""}),$(this._secondViewContainer).animate({top:bottom+"px"},250)):($(this._firstViewContainer).css({height:bottom+"px",bottom:""}),$(this._secondViewContainer).css({top:bottom+"px",height:newPosition+"px"})),$(this.dragElement).css("top",newPosition-$(this.dragElement).height()/2+"px")),this._currentPosition=newPosition,this.trigger("resize"))},SplitView.prototype.handleWindowResize=function(event){if(this._currentPosition!=null)return this.position(this._currentPosition)},SplitView.prototype.setFirstView=function(view){return this.firstView&&this.firstView.removeFromSuperview(),this.firstView=view,this.addSubview(view,this._firstViewContainer)},SplitView.prototype.setSecondView=function(view){return this.secondView&&this.secondView.removeFromSuperview(),this.secondView=view,this.addSubview(view,this._secondViewContainer)},SplitView.prototype.onMouseDown=function(event){if(!this.isResizable)return;return this.isResizing=!0},SplitView.prototype.onMouseUp=function(event){if(!this.isResizable)return;return this.isResizing=!1},SplitView.prototype.onMouseMove=function(event){var offset;if(!this.isResizable||!this.isResizing)return;return event.preventDefault(),this.orientation==="vertical"?(offset=$(this.el).offset().left,this.position(event.pageX-$(this.dragElement).width()/2-offset)):(offset=$(this.el).offset().top,this.position(event.pageY-$(this.dragElement).height()/2-offset))},SplitView}(Cartilage.View)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Cartilage.Views.UsageBarView=function(_super){function UsageBarView(){return UsageBarView.__super__.constructor.apply(this,arguments)}return __extends(UsageBarView,_super),UsageBarView}(Cartilage.Views.BarView)}.call(this),function(){}.call(this);